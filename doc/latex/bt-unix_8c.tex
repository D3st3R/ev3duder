\hypertarget{bt-unix_8c}{}\section{src/bt-\/unix.c File Reference}
\label{bt-unix_8c}\index{src/bt-\/unix.\+c@{src/bt-\/unix.\+c}}


Unix bluetooth I/\+O wrappers.  


{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$termios.\+h$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$fcntl.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$sys/types.\+h$>$}\\*
{\ttfamily \#include $<$sys/stat.\+h$>$}\\*
{\ttfamily \#include \char`\"{}defs.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{bt-unix_8c_a9ed5212b4acf61bb0f7b9b9078ba67ae}{B\+T}~\char`\"{}/dev/cu.\+E\+V3-\/Serial\+Port\char`\"{}
\begin{DoxyCompactList}\small\item\em default serial port name on O\+S X \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \hyperlink{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55bacb9be765f361bb7efb9073730aac92c6}{R\+E\+A\+D} =0, 
\hyperlink{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55ba61aa7ff70b76bff0fda378cf61d6afbc}{W\+R\+I\+T\+E} =1
 \}\begin{DoxyCompactList}\small\item\em open(2)s serial port described by device. {\ttfamily N\+U\+L\+L} leads to default action \end{DoxyCompactList}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void $\ast$ \hyperlink{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}{bt\+\_\+open} (const char $\ast$file, const char $\ast$file2)
\begin{DoxyCompactList}\small\item\em open a bluetooth device described by device. {\ttfamily N\+U\+L\+L} leads to default action \end{DoxyCompactList}\item 
int \hyperlink{bt-unix_8c_acbb62c11a110c097a4a9be010af9c4e7}{bt\+\_\+write} (void $\ast$fd\+\_\+, const \hyperlink{defs_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8} $\ast$buf, size\+\_\+t count)
\begin{DoxyCompactList}\small\item\em writes buf\mbox{[}1\mbox{]} till buf\mbox{[}count -\/ 2\mbox{]} to device \end{DoxyCompactList}\item 
int \hyperlink{bt-unix_8c_a0100d3e3520a9b774896f6b2a2f589f5}{bt\+\_\+read} (void $\ast$fd\+\_\+, \hyperlink{defs_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8} $\ast$buf, size\+\_\+t count, int milliseconds)
\begin{DoxyCompactList}\small\item\em writes buf\mbox{[}1\mbox{]} till buf\mbox{[}count -\/ 2\mbox{]} to device \end{DoxyCompactList}\item 
void \hyperlink{bt-unix_8c_a66111b994dc31a22f27679a286c338e4}{bt\+\_\+close} (void $\ast$\hyperlink{ev3__io_8h_aa0fee4a3e0cbfef079dcc441aaf8a8bf}{handle})
\begin{DoxyCompactList}\small\item\em Closes the file descriptor opened by \hyperlink{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}{bt\+\_\+open()} \end{DoxyCompactList}\item 
const wchar\+\_\+t $\ast$ \hyperlink{bt-unix_8c_a91cd0489b6e5dc0973109579ca9c7a55}{bt\+\_\+error} (void $\ast$fd\+\_\+)
\begin{DoxyCompactList}\small\item\em Returns an error string describing the last error occured. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Unix bluetooth I/\+O wrappers. 

\begin{DoxyAuthor}{Author}
Ahmad Fatoum 
\end{DoxyAuthor}
\begin{DoxyCopyright}{Copyright}
(c) 2015 Ahmad Fatoum. Code available under terms of the G\+N\+U General Public License 3.\+0 
\end{DoxyCopyright}


\subsection{Macro Definition Documentation}
\hypertarget{bt-unix_8c_a9ed5212b4acf61bb0f7b9b9078ba67ae}{}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!B\+T@{B\+T}}
\index{B\+T@{B\+T}!bt-\/unix.\+c@{bt-\/unix.\+c}}
\subsubsection[{B\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\+T~\char`\"{}/dev/cu.\+E\+V3-\/Serial\+Port\char`\"{}}\label{bt-unix_8c_a9ed5212b4acf61bb0f7b9b9078ba67ae}


default serial port name on O\+S X 



Definition at line 20 of file bt-\/unix.\+c.



\subsection{Enumeration Type Documentation}
\hypertarget{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55b}{}\subsubsection[{anonymous enum}]{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}\label{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55b}


open(2)s serial port described by device. {\ttfamily N\+U\+L\+L} leads to default action 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em device} & path to Serial\+Port or {\ttfamily N\+U\+L\+L} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\&fd pointer to file descriptor for use with bt\+\_\+\{read,write,close,error\} 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Bug}
\item[{\bf Bug}]default value should be enumerating. Not hardcoded like in {\ttfamily B\+T} \end{DoxyRefDesc}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{R\+E\+A\+D@{R\+E\+A\+D}!bt-\/unix.\+c@{bt-\/unix.\+c}}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!R\+E\+A\+D@{R\+E\+A\+D}}\item[{\em 
\hypertarget{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55bacb9be765f361bb7efb9073730aac92c6}{}R\+E\+A\+D\label{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55bacb9be765f361bb7efb9073730aac92c6}
}]\index{W\+R\+I\+T\+E@{W\+R\+I\+T\+E}!bt-\/unix.\+c@{bt-\/unix.\+c}}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!W\+R\+I\+T\+E@{W\+R\+I\+T\+E}}\item[{\em 
\hypertarget{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55ba61aa7ff70b76bff0fda378cf61d6afbc}{}W\+R\+I\+T\+E\label{bt-unix_8c_a06fc87d81c62e9abb8790b6e5713c55ba61aa7ff70b76bff0fda378cf61d6afbc}
}]\end{description}
\end{Desc}


Definition at line 28 of file bt-\/unix.\+c.



\subsection{Function Documentation}
\hypertarget{bt-unix_8c_a66111b994dc31a22f27679a286c338e4}{}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!bt\+\_\+close@{bt\+\_\+close}}
\index{bt\+\_\+close@{bt\+\_\+close}!bt-\/unix.\+c@{bt-\/unix.\+c}}
\subsubsection[{bt\+\_\+close(void $\ast$handle)}]{\setlength{\rightskip}{0pt plus 5cm}void bt\+\_\+close (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{handle}
\end{DoxyParamCaption}
)}\label{bt-unix_8c_a66111b994dc31a22f27679a286c338e4}


Closes the file descriptor opened by \hyperlink{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}{bt\+\_\+open()} 

Closes the resource opened by {\ttfamily bt\+\_\+open}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em device} & handle returned by \hyperlink{btserial_8h_a9d1ed570025eb554c752cea2bf974251}{bt\+\_\+open()} \\
\hline
\end{DoxyParams}


Definition at line 116 of file bt-\/unix.\+c.

\hypertarget{bt-unix_8c_a91cd0489b6e5dc0973109579ca9c7a55}{}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!bt\+\_\+error@{bt\+\_\+error}}
\index{bt\+\_\+error@{bt\+\_\+error}!bt-\/unix.\+c@{bt-\/unix.\+c}}
\subsubsection[{bt\+\_\+error(void $\ast$fd\+\_\+)}]{\setlength{\rightskip}{0pt plus 5cm}const wchar\+\_\+t$\ast$ bt\+\_\+error (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{fd\+\_\+}
\end{DoxyParamCaption}
)}\label{bt-unix_8c_a91cd0489b6e5dc0973109579ca9c7a55}


Returns an error string describing the last error occured. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em device} & handle returned by \hyperlink{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}{bt\+\_\+open()} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
message An error string 
\end{DoxyReturn}


Definition at line 127 of file bt-\/unix.\+c.

\hypertarget{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}{}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!bt\+\_\+open@{bt\+\_\+open}}
\index{bt\+\_\+open@{bt\+\_\+open}!bt-\/unix.\+c@{bt-\/unix.\+c}}
\subsubsection[{bt\+\_\+open(const char $\ast$file, const char $\ast$file2)}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ bt\+\_\+open (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file\+\_\+in, }
\item[{const char $\ast$}]{file\+\_\+out}
\end{DoxyParamCaption}
)}\label{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}


open a bluetooth device described by device. {\ttfamily N\+U\+L\+L} leads to default action 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\+\_\+in} & string describing the bluetooth device \\
\hline
\mbox{\tt in}  & {\em only} & for $\ast$nix\+: non-\/\+N\+U\+L\+L for cases where read/write files differ \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
handle a opaque handle for use with bt\+\_\+\{read,write,close,error\} 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
implementation at \hyperlink{bt-win_8c}{bt-\/win.\+c} and \hyperlink{bt-unix_8c}{bt-\/unix.\+c} 
\end{DoxySeeAlso}


Definition at line 29 of file bt-\/unix.\+c.

\hypertarget{bt-unix_8c_a0100d3e3520a9b774896f6b2a2f589f5}{}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!bt\+\_\+read@{bt\+\_\+read}}
\index{bt\+\_\+read@{bt\+\_\+read}!bt-\/unix.\+c@{bt-\/unix.\+c}}
\subsubsection[{bt\+\_\+read(void $\ast$fd\+\_\+, u8 $\ast$buf, size\+\_\+t count, int milliseconds)}]{\setlength{\rightskip}{0pt plus 5cm}int bt\+\_\+read (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{fd\+\_\+, }
\item[{{\bf u8} $\ast$}]{buf, }
\item[{size\+\_\+t}]{count, }
\item[{int}]{milliseconds}
\end{DoxyParamCaption}
)}\label{bt-unix_8c_a0100d3e3520a9b774896f6b2a2f589f5}


writes buf\mbox{[}1\mbox{]} till buf\mbox{[}count -\/ 2\mbox{]} to device 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em device} & handle returned by \hyperlink{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}{bt\+\_\+open()} \\
\hline
\mbox{\tt in}  & {\em buf} & buffer to write to \\
\hline
\mbox{\tt in}  & {\em count} & number of characters to be read \\
\hline
\mbox{\tt in}  & {\em milliseconds} & number of milliseconds to wait at maximum. -\/1 is indefinitely \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status -\/1 on error. bytes read otherwise. 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000003}{Bug}]the milliseconds part needs to be tested more throughly \end{DoxyRefDesc}


Definition at line 77 of file bt-\/unix.\+c.

\hypertarget{bt-unix_8c_acbb62c11a110c097a4a9be010af9c4e7}{}\index{bt-\/unix.\+c@{bt-\/unix.\+c}!bt\+\_\+write@{bt\+\_\+write}}
\index{bt\+\_\+write@{bt\+\_\+write}!bt-\/unix.\+c@{bt-\/unix.\+c}}
\subsubsection[{bt\+\_\+write(void $\ast$fd\+\_\+, const u8 $\ast$buf, size\+\_\+t count)}]{\setlength{\rightskip}{0pt plus 5cm}int bt\+\_\+write (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{fd\+\_\+, }
\item[{const {\bf u8} $\ast$}]{buf, }
\item[{size\+\_\+t}]{count}
\end{DoxyParamCaption}
)}\label{bt-unix_8c_acbb62c11a110c097a4a9be010af9c4e7}


writes buf\mbox{[}1\mbox{]} till buf\mbox{[}count -\/ 2\mbox{]} to device 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em handle} & handle returned by \hyperlink{bt-unix_8c_a604b81ec74c835b44c026a6af353e8d6}{bt\+\_\+open()} \\
\hline
\mbox{\tt in}  & {\em buf} & byte string to write, the first byte is omitted \\
\hline
\mbox{\tt in}  & {\em count} & number of characters to be written (including leading ignored byte) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status -\/1 on error. bytes read otherwise. 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000002}{Bug}]the first byte is omitted for compatiblity with the leading report byte demanded by {\ttfamily hid\+\_\+write}. Wrapping H\+I\+D\+A\+P\+I could fix this. \end{DoxyRefDesc}


Definition at line 51 of file bt-\/unix.\+c.

